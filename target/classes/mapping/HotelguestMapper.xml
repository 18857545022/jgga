<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN"      
 "http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">

<mapper namespace="ssm.model.HotelguestMapper">
	<select id="getHotelCount" resultType="string">
		select zjhm
		FROM hotelguest
		where rzsj BETWEEN SUBDATE(SYSDATE(),INTERVAL ${param1} month) AND SYSDATE()
		group BY zjhm
		HAVING count(1)>#{param2}
	</select>

	<select id="getByZjhm" resultType="ssm.pojo.Hotelguest" >
		select *
		from hotelguest
		where zjhm=#{param2}
		AND rzsj BETWEEN SUBDATE(SYSDATE(),INTERVAL ${param1} month) and SYSDATE()
		ORDER BY rzsj desc
	</select>

	<select id="getByZklsh" parameterType="string" resultType="ssm.pojo.Hotelguest" >
		select *
		from hotelguest
		where zklsh=#{zklsh}
	</select>

	<select id="getByXb_history"  resultType="ssm.pojo.Hotelguest" >
		select *
		FROM hotelguest
		WHERE TO_DAYS(rzsj)=TO_DAYS(now())-${param2}
		AND xb=#{param1};
	</select>

	<select id="getByXb_update"  resultType="ssm.pojo.Hotelguest" >
		select *
		FROM hotelguest
		WHERE rzsj BETWEEN  SUBDATE(SYSDATE(),INTERVAL ${param2} hour) and SYSDATE()
		AND xb=#{param1};
	</select>

	<select id="get_history" parameterType="int" resultType="ssm.pojo.Hotelguest">
		select *
		FROM hotelguest
		WHERE TO_DAYS(rzsj)=TO_DAYS(now())-#{param1};
	</select>

	

</mapper>